%dist=[0,8,27,53,76,87,96,108,125,149,169,187,213,245,268,289,313,332,345,362,388,420,448,479,511,543,575,607,634,660,679,691,702,717,741,772,795,815,838,858,877,900,925,942,955,963,970,976,989,1012,1032,1046,1051,1053,1054,1056,1063,1080,1102,1128,1150,1160,1168,1185,1205,1224,1243,1262,1279,1291,1302,1318,1338,1362,1390,1422,1450,1476,1496,1509,1520,1531,1546,1564,1581,1596,1610,1625,1645,1668,1689,1711,1736,1758,1778,1802,1833,1861,1885,1911,1939,1969,1996,2015,2022,2028,2043,2066,2091,2113,2138,2169,2197,2217,2230,2241,2256,2280,2306,2329,2355,2382,2405,2426,2445,2462,2480,2504,2532,2559,2582,2607,2632,2648,2658,2668,2683,2707,2731,2755,2785,2813,2838,2860,2884,2911,2938,2967,2990,3004,3010,3017,3034,3051,3068,3093,3115,3135,3163,3186,3202,3222,3247,3275,3304,3331,3360,3387,3411,3433,3453,3471,3493,3522,3545,3556,3568,3590,3619,3647,3666,3677,3686,3695,3703,3715,3736,3764,3792,3816,3837,3857,3878,3900,3924,3956,3983,4009,4035,4053,4060,4071,4087,4095,4098,4109,4134,4163,4194,4222,4247,4270,4291,4312];
x=1:214;
da=[380,280,190,260,340,410,320,220,220,120,20,1,61,201,201,271,371,451,401,361,301,201,101,1,1,1,1,41,1,1,31,51,1,1,1,131,121,151,231,291,201,141,171,111,191,211,301,301,201,121,21,1,11,171,181,281,341,441,341,371,431,421,381,291,201,101,21,21,1,1,101,1,1,1,1,191,291,231,291,231,311,271,181,181,81,31,1,41,1,1,201,301,401,491,461,411,371,331,301,221,131,101,1,1,111,11,1,81,71,201,241,341,391,291,191,91,111,11,1,1,1,1,1,1,1,111,211,171,91,101,61,201,151,251,281,351,451,411,471,411,371,331,231,251,151,111,11,1,71,201,301,261,171,261,161,61,1,1,181,81,41,11,1,201,301,291,201,291,371,281,331,311,281,261,241,221,221,181,141,71,101,171,211,141,181,81,1,1,11,1,1,1,91,31,171,71,101,1,151,51,141,241,311,211,301,371,271,181,281,191,221,321,221,121];
%plot(dist,da)
po=[620,520,420,350,250,150,50,31,31,161,261,221,191,271,191,271,191,271,191,271,191,271,191,271,191,291,251,151,51,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,201,261,311,211,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,291,251,151,51,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,201,261,311,211,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,291,251,151,51,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,201,281,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,271,191,291,251,151,51,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,191,91,201,261,301,201,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,161,131,131,221,181,181,191,91,1,61,1,171,111,101,41,41,41,31,81,81,81,81,81,81,201,301,381,381,371,271,251,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,121,21,11,11,1,1,1,1,1,1,1,1];




di=[0,4,10,16,22,27,31,35,38,40,41,43,46,49,52,55,58,61,64,67,70,73,76,79,82,85,88,91,94,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,140,142,144,146,148,150,152,154,156,158,160,162,164,166,168,170,172,174,176,178,180,182,184,186,188,190,192,194,196,198,200,202,204,206,208,210,212,214,216,218,220,222,224,226,228,230,232,234,236,238,240,242,244,246,248,250,252,254,256,259,262,265,268,271,274,277,280,283,286,289,292,295,298,301,304,307,310,313,316,319,322,325,328,331,334,337,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,376,378,380,382,384,386,388,390,392,394,396,398,400,402,404,406,408,410,412,414,416,418,420,422,424,426,428,430,432,434,436,438,440,442,444,446,448,450,452,454,456,458,460,462,464,466,468,470,472,474,476,478,480,482,484,486,488,490,493,496,499,502,505,508,511,514,517,520,523,526,529,532,535,538,541,544,547,550,553,556,559,562,565,568,570,572,574,576,578,580,582,584,586,588,590,592,594,596,598,600,602,604,606,608,610,612,614,616,618,620,622,624,626,628,630,632,634,636,638,640,642,644,646,648,650,652,654,656,658,660,662,664,666,668,670,672,674,676,678,680,682,684,686,688,690,692,694,696,698,700,702,704,706,708,710,712,714,717,720,723,726,729,732,735,738,741,744,747,750,753,756,759,762,765,768,771,774,777,780,783,786,789,791,793,795,797,799,801,803,805,807,809,811,813,815,817,819,821,823,825,827,829,831,833,835,837,839,841,843,845,847,849,851,853,855,857,859,861,863,865,867,869,871,873,875,877,879,881,883,885,887,889,891,893,895,897,899,901,903,905,907,909,911,913,915,917,919,922,925,928,931,934,937,940,943,946,949,952,955,958,961,964,967,970,973,976,979,982,985,988,991,994,996,998,1000,1004,1011,1019,1028,1038,1048,1059,1070,1082,1094,1107,1120,1133,1146,1160,1174,1188,1202,1216,1230,1244,1258,1273,1288,1303,1318,1333,1348,1364,1380,1396,1412,1428,1444,1460,1476,1492,1508,1524,1540,1556,1572,1588,1604,1620,1636,1652,1668,1684,1700,1716,1732,1748,1764,1780,1796,1812,1827,1842,1857,1872,1887,1902,1917,1932,1947,1962,1977];



plot(di,po)
[das] = window_smooth(po,15);

plot(di,das);
% x=[0:pi/8:2*pi];
% y=[203,200,195,196,203,203,200,206];
% lime=[190,206;190,206;190,206;190,206;190,206;190,206;190,206;190,206];
% label={'NW','W','SW','S','SE','E','NE','N'};
% %polar(x,y,'b')
% Draw_radar(y,lime,label)
% function Draw_radar(data,lim,labels)
%data是要画图的数据（根据数据的个数来确定雷达图的轴数）
%lim是各指标画图上下限范围
%labels是坐标轴名称
%     n=length(data);%维度
%     adj_data=zeros(n,1);
%     point=zeros(n,2);
%     
%     set(gca,'units','normal','pos',[0 0 1 1]);
%     axis off
%     axis equal
%     hold on
%     theta_last=pi/2;
%     for i=1:n
%         theta=2*pi/n*i+pi/2;
%         plot([0,500*cos(theta)],[0,500*sin(theta)],'k-','linewidth',2);
%         for j=1:5
%            plot([j*100*cos(theta_last),j*100*cos(theta)],[j*100*sin(theta_last),j*100*sin(theta)],'--','linewidth',0.75,'color',[0.5,0.5,0.5]);
%         end
%         
%         theta_last=theta;
%         if data(i)<lim(i,1)
%             adj_data(i)=0;
%         elseif data(i)>lim(i,2)
%             adj_data(i)=500;
%         else
%             adj_data(i)=(data(i)-lim(i,1))/(lim(i,2)-lim(i,1))*500;
%         end
%         point(i,1:2)=[adj_data(i)*cos(theta);adj_data(i)*sin(theta)];
%         text_around(510*cos(theta),510*sin(theta),labels{i},theta);
%     end
%     
%     for i=1:n
%         theta=2*pi/n*i+pi/2;
%         for j=1:5
%             text_around(j*100*cos(theta),j*100*sin(theta),num2str(lim(i,1)+(lim(i,2)-lim(i,1))/5*j),theta+pi/2,7);
%         end
%     end
%     plot([point(:,1);point(1,1)],[point(:,2);point(1,2)],'k-','linewidth',0.8);
%     fill(point(:,1),point(:,2),[0.9 0.9 0.7])
%     alpha(0.5);
%     texts=findobj(gca,'Type','Text');
%     minx=-300;
%     maxx=300;
%     miny=-300;
%     maxy=300;
%     for i=1:length(texts)
%         rect=get(texts(i),'Extent');
%         x=rect(1);
%         y=rect(2);
%         dx=rect(3);
%         dy=rect(4);
%         if x<minx
%             minx=x;
%         elseif x+dx>maxx
%             maxx=x+dx;
%         end
%         if y<miny
%             miny=y;
%         elseif y+dy>maxy
%             maxy=y+dy;
%         end
%     end
%     axis([minx-50,maxx+50,miny-20,maxy+20]);
% end
%  
% function text_around(x,y,txt,theta,fontsize)
%     if nargin==4
%         fontsize=10;
%     end
%     section=mod(theta+pi/12,2*pi);
%     if section>pi+pi/6
%         %上对齐
%         if section>1.5*pi+pi/6
%             %左对齐
%             text(x,y,txt,'VerticalAlignment','cap','HorizontalAlignment','left','Fontsize',fontsize);
%         elseif section>1.5*pi
%             %中对齐
%             text(x,y,txt,'VerticalAlignment','cap','HorizontalAlignment','center','Fontsize',fontsize);
%         else
%             %右对齐
%             text(x,y,txt,'VerticalAlignment','cap','HorizontalAlignment','right','Fontsize',fontsize);
%         end
%     elseif section>pi
%         %中、右对齐
%         text(x,y,txt,'VerticalAlignment','middle','HorizontalAlignment','right','Fontsize',fontsize);
%     elseif section>pi/6
%         %下对齐
%         if section>0.5*pi+pi/6
%             %右对齐
%             text(x,y,txt,'VerticalAlignment','bottom','HorizontalAlignment','right','Fontsize',fontsize);
%         elseif section>0.5*pi
%             %中对齐
%             text(x,y,txt,'VerticalAlignment','bottom','HorizontalAlignment','center','Fontsize',fontsize);
%         else
%             %左对齐
%             text(x,y,txt,'VerticalAlignment','bottom','HorizontalAlignment','left','Fontsize',fontsize);
%         end
%     else
%         %中、左对齐
%         text(x,y,txt,'VerticalAlignment','middle','HorizontalAlignment','left','Fontsize',fontsize);
%     end
% end
% 
function [data_m] = window_smooth(data,n)
%n为窗口长度
L = length(data);%数据长度
 
%均值滤波
m = 0;
k = 0;
for i =1:L
    if(i<n)
        data_m(i) = data(i);
    else
       for(j = i-n+1:i)
           k = k+1;
       w1(k) = data(j);
       end
    data_m(i) = mean(w1);
    k = 0;
    end
end
end